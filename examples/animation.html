<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Movable Ink SDK - Animation</title>
  <link rel="stylesheet" href="/css/style.css">

  <style type="text/css" media="screen">
    table {
      border-spacing: 0;
      border-collapse: collapse;
      margin-left: 10px;
      font-family: Arial, sans-serif;
      color: #2675ad;
    }

    td {
      font-size: 24px;
      line-height: 30px;
      text-align: center;
      font-weight: normal;
      padding-top: 0px;
      padding-right: 0px;
      padding-bottom: 0px;
      padding-left: 0px;
    }

    .label {
      font-size: 14px;
    }

    .separator {
      min-width: 10px;
    }
  </style>

</head>
<body>

<header>
  <a href="../index.html" class="link-back -absolute-center -white">BACK TO FAQ</a>
  <h1>Movable Ink SDK Index - Animation</h1>
</header>


<div class="container-content -med_width">
  <div class="content">
      <h4>Content to be cropped</h4>
    <table>
      <tbody>
        <tr class="labels_row">
          <td class="label">Days</td>
          <td></td>
          <td class="label">Hrs</td>
          <td></td>
          <td class="label">Min</td>
          <td></td>
          <td class="label">Sec</td>
        </tr>
        <tr class="numbers_row">
          <td class="number" id="days">26</td>
          <td class="separator">:</td>
          <td class="number" id="hours">23</td>
          <td class="separator">:</td>
          <td class="number" id="minutes">51</td>
          <td class="separator">:</td>
          <td class="number" id="seconds">45</td>
        </tr>
      </tbody>
    </table>

    <h4>About Animations</h4>
    <p>This page features code from the countdown timer app in the Movable Ink interface (with a few modifications).  It is programmed to always show the amount of time between now and 3pm, five calendar days in the future.</p>
    <p>The Movable Ink crop that is programmed to crop this page also has the animation feature checked.  That means the MI server will visit this page, take a snapshot, execute the "<a onClick="manualAdvance(); return false;" href="#">manualAdvance()</a>" function, take another shot, execute "<a onClick="manualAdvance(); return false;" href="#">manualAdvance()</a>" again... and do this 60 times.  Once all 60 snapshots are taken, the server will compose an animated gif and deliver that to the email recipient.</p>
    <p>If you are creating a crop with an animation, be mindful of how much data you're trying to pack in an animated gif.  A 500px by 400px image at 60 frames is functionally 12 megapixels of data.  This will probably take too long for an email, as the MI server must snapshot and assemble all this data before it can initiate the delivery of a potentially large file.</p>



  </div>
</div>


<a href="../index.html" class="link-back -black">BACK TO FAQ</a>
<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.1.min.js"></script>

    <script>
      var totalHours = false;   /* When false, hrs is a range from 0 to 23.  True is from 0 to infinity*/
      var totalMinutes = false; /* Same as above, except 0 to 59 */
      var stopAt99 = false;     /* Set to true if everything should stop at 99 */
      var padWithZeros = true;  /* numbers like "5" appear as "05" */

      /* ############################################## */
      /*                 Advanced Stuff                 */
      /* ############################################## */
      // Time the coundown ends
      var time = new Date();
      var endTime = new Date();
      endTime.setDate(endTime.getDate() + 5);
      endTime.setHours(3);
      endTime.setMinutes(0);
      endTime.setSeconds(0);
      var interval  = 1000;

      // Collect the DOM ids
      var daysElement    = document.getElementById("days");
      var hoursElement   = document.getElementById("hours");
      var minutesElement = document.getElementById("minutes");
      var secondsElement = document.getElementById("seconds");

      // manualAdvance() gets called by Movable Ink once per frame.
      // In this instance it advances endTime forward one second and
      // redraws the date for each frame.
      function manualAdvance() {
        advanceTime();
      }

      function advanceTime() {
        time = new Date(time.getTime() + interval);
        setTime();
      }

      function setTime() {
        if(secondsElement) {
          secondsElement.innerHTML = pad(secondsBetween(time, endTime), 2);
        }

        if(minutesElement) {
          if (totalMinutes == true) {
            minutesElement.innerHTML = pad(totalMinutesBetween(time, endTime), 2);
          } else {
            minutesElement.innerHTML = pad(minutesBetween(time, endTime), 2);
          }
        }

        if(hoursElement) {
          if (totalHours == true) {
            hoursElement.innerHTML = pad(totalHoursBetween(time, endTime), 2);
          } else {
            hoursElement.innerHTML = pad(hoursBetween(time, endTime), 2);
          }
        }

        if(daysElement) {
          daysElement.innerHTML = pad(daysBetween(time, endTime), 2);
        }
      }

      // run once immediately to set the current time
      setTime();

      // for debugging only:
      if(param('debug')) {
        // run every interval to advance the time
        setInterval(advanceTime, interval);
      }


      // Helper functions

      function secondsBetween(start, finish) {
        return totalSecondsBetween(start, finish) % 60;
      }

      function minutesBetween(start, finish) {
        return totalMinutesBetween(start, finish) % 60;
      }

      function hoursBetween(start, finish) {
        return totalHoursBetween(start, finish) % 24;
      }

      function daysBetween(start, finish) {
        return Math.floor(totalHoursBetween(start, finish) / 24);
      }

      function totalSecondsBetween(start, finish) {
        return Math.floor(Math.max(finish.getTime() - start.getTime(), 0) / 1000);
      }

      function totalMinutesBetween(start, finish) {
        return Math.floor(totalSecondsBetween(start, finish) / 60);
      }

      function totalHoursBetween(start, finish) {
        return Math.floor(totalMinutesBetween(start, finish) / 60);
      }

      // Pad a number with zeroes
      function pad(number, zeroes) {
        if (stopAt99 == true) {
          if (number > 99) {
            number = 99;
          }
        }
        if (padWithZeros == true) {
          number += "";
          while(number.length < zeroes) {
            number = "0" + number;
          }
        }
        return number;
      }

      // Extract a query param from the URL
      function param(name) {
        if(typeof(urlParams) == "undefined") {
          urlParams = {};
          (function () {
             var match,
                 search = /([^&=]+)=?([^&]*)/g,
                 decode = function (s) { return decodeURIComponent(s); },
                 query  = window.location.search.substring(1);

             while (match = search.exec(query))
               urlParams[decode(match[1])] = decode(match[2]);
          })();
        }
        return urlParams[name];
      }

    </script>
</body>
</html>