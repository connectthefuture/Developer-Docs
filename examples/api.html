<html>
  <head>
    <title>API integration</title>

    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.1.min.js"></script>

    <style type="text/css" media="all">

#to_be_cropped {
  width: 300px;
  padding: 20px;
  font-size: 14px;
  text-align: left;
  font-family: "times new roman";
  background-color: #F3EEFC;
  color: #022909;
}

    </style>
  </head>

  <body>


    <h2>Content to be cropped</h2>

    <div id="to_be_cropped">
    </div>

    <a id="dynamic_link" href="http://www.reddit.com/r/technology">dynamic link</a>

    <p>Because Movable Ink relies on a very standard, open technology, it makes integration with APIs very easy.  In this example, we using the Reddit API to populate this page with the top story in <a href="http://www.reddit.com/r/technology">reddit.com/r/technology</a>.</p>
    <p>Admittedly this particular implementation is hardly an API as much as it is an open .json endpoint.  Hopefully this page illustrates that if you can access your data via the web (even with more sophisticated authentication schemas), it can get published in an email and rendered in real time.</p>
    <p>When matched with <a href="personalized.html">personalization</a>, you can effectively make Movable Ink images rasterized iframes that are customized on a per recipient basis.</p>

    <h3>Implementation Notes</h3>
    <p>For a number of reasons (image delivery time, server health), we are quite strict about how eagerly we take snapshots of websites.  Consequently, we snapshot as soon as the DOM reports that it is ready.</p>
    <p>Because of this, we discourage the standard web practice of executing JS after the DOM for MI crop sources.  Additionally, AJAX calls should be made synchronous.</p>
    <p>Lastly, if you are running into Cross-Origin issues, Movable Ink offers a cors service to all of our clients.  In addition to enabling cross-origin requests, cors.movableink.com intelligently caches identical requests for 10 seconds.  This allows multiple crops for one email to operate on the same API response.  It also helps avoid excessive traffic flooding the API endpoints.</p>

    <script type="text/javascript">
      $.ajax({
        async: false,
        url: 'http://cors.movableink.com/www.reddit.com/r/technology.json'
      }).done(function(response) {
        var story = response.data.children[0].data;
        $('#to_be_cropped').html(story.title);
        $('#dynamic_link').attr('href', story.url);
      });
    </script>
  </body>
</html>
